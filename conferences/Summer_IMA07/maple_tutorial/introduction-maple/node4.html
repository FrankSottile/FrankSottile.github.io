<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Equation Solving in Maple</TITLE>
<META NAME="description" CONTENT="Equation Solving in Maple">
<META NAME="keywords" CONTENT="introduction-maple">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="introduction-maple.css">

<LINK REL="next" HREF="node5.html">
<LINK REL="previous" HREF="node3.html">
<LINK REL="up" HREF="introduction-maple.html">
<LINK REL="next" HREF="node5.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html52"
  HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html50"
  HREF="introduction-maple.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html44"
  HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html53"
  HREF="node5.html">Basic Programming in Maple</A>
<B> Up:</B> <A NAME="tex2html51"
  HREF="introduction-maple.html">An introduction to Maple</A>
<B> Previous:</B> <A NAME="tex2html45"
  HREF="node3.html">First steps</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION0004000000000000000000">
Equation Solving in Maple</A>
</H1>

<P>
Maple has many algebraic and numerical tools for finding the solutions to
systems of (not necessarily polynomial) equations.  Perhaps the simplest black-box
solver is provided by the appropriately named function <TT>solve</TT>.
As a first example, we will solve the following 
system of linear equations in <IMG
 WIDTH="52" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img18.png"
 ALT="$ x,y,z$"> and <IMG
 WIDTH="16" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img19.png"
 ALT="$ u$"> and free parameters <IMG
 WIDTH="48" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.png"
 ALT="$ a,b,c$"> and <IMG
 WIDTH="15" HEIGHT="20" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.png"
 ALT="$ d$">.  

<P>
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="124" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img22.png"
 ALT="$\displaystyle 3x + y + z - u$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="35" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img23.png"
 ALT="$\displaystyle = a$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="162" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img24.png"
 ALT="$\displaystyle 13x + 8y + 6z - 7u$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="33" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img25.png"
 ALT="$\displaystyle = b$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="171" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img26.png"
 ALT="$\displaystyle 14x + 10y + 6z - 7u$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="33" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img27.png"
 ALT="$\displaystyle = c$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="153" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.png"
 ALT="$\displaystyle 7x + 4y + 3z - 3u$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="35" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img29.png"
 ALT="$\displaystyle = d$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
To input and solve this system in Maple, we execute the following line of code.

<P>
<PRE>
solve({3*x+y+z-u-a, 13*x+8*y+6*z-7*u-b, 14*x+10*y+6*z-7*u-c,
	       7*x+4*y+3*z-3*u-d},{x,y,z,u});
</PRE>

<P>
In general, the first input parameter to <TT>solve</TT> is a list of expressions 
presented in the form <!-- MATH
 $\{f_1,\dots,f_n\}$
 -->
<IMG
 WIDTH="101" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img30.png"
 ALT="$ \{f_1,\dots,f_n\}$"> followed by a list of variables to ``solve" for.  In this
case (and generally), the output from the calculation is given as (sequences of) lists such as

<P>
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="25" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img31.png"
 ALT="$\displaystyle \{u$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="286" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img32.png"
 ALT="$\displaystyle = -(6/5a+4/5b+1/5c-12/5d),$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="15" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img33.png"
 ALT="$\displaystyle z$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="296" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img34.png"
 ALT="$\displaystyle = -(16/5a-1/5b+6/5c-17/5d),$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="15" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img35.png"
 ALT="$\displaystyle y$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="277" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img36.png"
 ALT="$\displaystyle = -(3/5a+2/5b-2/5c-1/5d),$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="16" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img37.png"
 ALT="$\displaystyle x$"></TD>
<TD NOWRAP ALIGN="LEFT"><IMG
 WIDTH="296" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img38.png"
 ALT="$\displaystyle = -(-6/5a+1/5b-1/5c+2/5d)\}$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
For those interested in a matrix approach to solving these equations, the following
code is appropriate.

<P>
<PRE>
M := [[3,1,1,-1],[13,8,6,-7],[14,10,6,-7],[7,4,3,-3]]:
v := matrix(4,1,[a,b,c,d]):
evalm(inverse(M)&amp;*v);   	# &amp;* is used to multiply two matrices
</PRE>

<P>
It is constructive to play around with the function <TT>solve</TT> to see what it does
on various types of inputs.  For instance, how does it handle equations with an infinite number
of solutions or for which there are no solutions?  

<P>
<PRE>
# degenerate linear equation
solve({t*x + t^2*y - t, x + t*y - 1},{x,y});
# {x = -t y + 1, y = y}

# linear equation with no solution
solve({t*x + t^2*y - 0, x + t*y - 1},{x,y});
</PRE>

<P>
For the first example, Maple returns a solution indicating that <IMG
 WIDTH="15" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img39.png"
 ALT="$ y$"> is a free parameter and that
<IMG
 WIDTH="16" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$ x$"> depends on this parameter in the manner indicated.  
In the second example, <TT>solve</TT> outputs nothing, indicating that there is no
solution to the system of equations.  In general, however, one must be skeptical of the
output from the function <TT>solve</TT>.  It does its best with the tools it has, but there is no
guarantee that it is giving you all correct solutions.  In the simple example below, Maple (incorrectly) does 
not exclude the case <!-- MATH
 $(x,y) = (0,0)$
 -->
<IMG
 WIDTH="115" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img40.png"
 ALT="$ (x,y) = (0,0)$"> in its list of solutions.

<P>
<PRE>
solve({y/x},{x,y});
# {x = x, y = 0}
</PRE>

<P>
A companion to the function <TT>solve</TT> is a numerical solver <TT>fsolve</TT> which is called in the
same way as  <TT>solve</TT>.  An important difference, however, is that the number of 
equations must match the number of variables or else an error message will result.

<P>
<PRE>
fsolve(x^3-3*x+1,x);
# -1.879385242, .3472963553, 1.532088886

evalf(fsolve(x^3-3*x+1,x),20);
# -1.8793852415718167681, 0.34729635533386069770, 1.5320888862379560704
</PRE>

<P>
Above, we used another function <TT>evalf</TT> to extend the accuracy of our solution to 
<IMG
 WIDTH="24" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ 20$"> digits.  This function is also important when one has a symbolic solution to an equation
that one wants to see approximately.  For instance, we could have solved the above 
equation first symbolically and then approximated the formula numerically.

<P>
<PRE>
solve(x^3-3*x+1,x);
evalf(%);
# 1.532088886 - 0.1*10^(-9) I, -1.879385241 - 0.1732050808*10^(-9) I, ...
</PRE>

<P>
The careful reader will notice that the output from these two examples is different - there is
a very small imaginary part (the complex number <IMG
 WIDTH="45" HEIGHT="42" ALIGN="MIDDLE" BORDER="0"
 SRC="img42.png"
 ALT="$ \sqrt{-1}$"> is denoted by <IMG
 WIDTH="15" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img43.png"
 ALT="$ I$"> in Maple)
that is detected by the second command.  Moreover, increasing
the number of digits of accuracy does not remove the problem.  So how do we resolve this issue?
Fortunately, there is a built-in function called <TT>realroot</TT> which gives (provably correct)
bounding boxes for the real roots of univariate polynomials.

<P>
<PRE>
e := 1:
realroot(x^3-3*x+1, e);
# [[0, 1], [1, 2], [-2, -1]]
</PRE>

<P>
The output here indicates that there are at least three real roots to the given equation and that
they lie inside each of the indicated intervals.  The variable <IMG
 WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.png"
 ALT="$ e$"> is used to
bound the size of the isolating intervals.  Setting <IMG
 WIDTH="86" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img45.png"
 ALT="$ e = 1/100$">, for instance, will produce bounding intervals
that are of length at most <IMG
 WIDTH="52" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img46.png"
 ALT="$ 1/100$">:

<P>
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="281" HEIGHT="59" ALIGN="MIDDLE" BORDER="0"
 SRC="img47.png"
 ALT="$\displaystyle [[{\frac {11}{32}},{\frac {45}{128}}],[{\frac {49}{32}},{\frac {197}{
128}}],[-{\frac {241}{128}},-{\frac {15}{8}}]]$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
We close this section with the function <TT>eliminate</TT>, which is very useful
for human-guided equation solving.

<P>
<PRE>
# intersecting hyperboloid and sphere
hyp := x^2+(y-3/2)^2-z^2-1/4;
sph := x^2+y^2+z^2-4;
eliminate( {hyp, sph}, x);
# [{x = RootOf(_Z^2+y^2+z^2-4)}, {-6+3*y+2*z^2}]
</PRE>

<P>
In this example, the variable <IMG
 WIDTH="16" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$ x$"> is eliminated from the equations, resulting in the new
equation <!-- MATH
 $-6+3y+2z^2 = 0$
 -->
<IMG
 WIDTH="155" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ -6+3y+2z^2 = 0$"> listed in the output.  Thus, we see that with <IMG
 WIDTH="15" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img49.png"
 ALT="$ z$"> a free variable, we
have <!-- MATH
 $y = (6-2z^2)/3$
 -->
<IMG
 WIDTH="132" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img50.png"
 ALT="$ y = (6-2z^2)/3$"> and <IMG
 WIDTH="16" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$ x$"> is given by the funny expression <!-- MATH
 $x = RootOf(\_Z^2+y^2+z^2-4)$
 -->
<IMG
 WIDTH="262" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img51.png"
 ALT="$ x = RootOf(\_Z^2+y^2+z^2-4)$">.
Although confusing, this is just Maple's way of symbolically representing roots of univariate
polynomials.  Translated into mathematics, the expression is simply saying that given <IMG
 WIDTH="15" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img39.png"
 ALT="$ y$"> and <IMG
 WIDTH="15" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img49.png"
 ALT="$ z$">,
the value for <IMG
 WIDTH="16" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$ x$"> can be chosen to be a root of the equation <!-- MATH
 $Z^2 + y^2+z^2-4 = 0$
 -->
<IMG
 WIDTH="175" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img52.png"
 ALT="$ Z^2 + y^2+z^2-4 = 0$">.  While this
might seem cumbersome, it is unavoidable.  For instance, how would one represent and manipulate
the solution to an unsolvable quintic?

<P>
<PRE>
soln := solve(x^5-x+1,x);
a := soln[1]; 
simplify(a^10);
</PRE>

<P>
There are other solving tools available such as the Gr&#246;bner basis libraries 
included in later versions of Maple.  However, we refer to 
<TT><A NAME="tex2html4"
  HREF="www.mapleprimes.com/blog/roman-pearce/improvements-to-maple-11-groebner">www.mapleprimes.com/blog/roman-pearce/improvements-to-maple-11-groebner</A></TT>which has numerous examples displaying the power of Faugere's FGb program implemented
in Maple 11.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html52"
  HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html50"
  HREF="introduction-maple.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html44"
  HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html53"
  HREF="node5.html">Basic Programming in Maple</A>
<B> Up:</B> <A NAME="tex2html51"
  HREF="introduction-maple.html">An introduction to Maple</A>
<B> Previous:</B> <A NAME="tex2html45"
  HREF="node3.html">First steps</A>
<!--End of Navigation Panel-->
<ADDRESS>
Frank Sottile
2007-07-23
</ADDRESS>
</BODY>
</HTML>
