
i1 : -- Table1.m2
     -- This generates Table 1, the Hilbert Function and Hilbert polynomial
     --  for the splines on the cell complex of Figure 1
     ----------------------------------------------------------------------
     --The ambient ring
     S=QQ[x,y,z];

i2 : --curvilinear boundaries
     F1=x;                      -- y-axis

i3 : F2=(x-z)^2+(y+z)^2-2*z^2;  -- circle centred at (1,-1) and radius 2

i4 : F3=(x)^2+(y-z)^2-z^2;      -- circle centred at (0,1) and radius 1

i5 : --the hilbertFunction and hilbertPolynomial of the curviliear spline determined by F1, F2 and F3.
     -- Table 1
     netList apply(toList(0..6),r->(
     	A=matrix{
       {1,-1,0,F1^(r+1),0,0},
       {0,1,-1,0,F2^(r+1),0},  
       {-1,0,1,0,0,F3^(r+1)}  
         };	{concatenate("r=",toString(r)),concatenate("hilbFun : ",toString(for i from 0 to 15 list hilbertFunction(i,ker A))),concatenate("hilbPoly : ",toString(hilbertPolynomial(ker A,Projective=>false)))}
     	))

     +---+------------------------------------------------------------------------------+---------------------------------+
o5 = |r=0|hilbFun : {1, 3, 6, 13, 23, 36, 52, 71, 93, 118, 146, 177, 211, 248, 288, 331}|hilbPoly : (3/2)*i^2-(1/2)*i+1   |
     +---+------------------------------------------------------------------------------+---------------------------------+
     |r=1|hilbFun : {1, 3, 6, 10, 15, 21, 30, 44, 61, 81, 104, 130, 159, 191, 226, 264} |hilbPoly : (3/2)*i^2-(11/2)*i+9  |
     +---+------------------------------------------------------------------------------+---------------------------------+
     |r=2|hilbFun : {1, 3, 6, 10, 15, 21, 28, 36, 45, 57, 73, 94, 118, 145, 175, 208}   |hilbPoly : (3/2)*i^2-(21/2)*i+28 |
     +---+------------------------------------------------------------------------------+---------------------------------+
     |r=3|hilbFun : {1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 66, 78, 93, 111, 134, 162}    |hilbPoly : (3/2)*i^2-(31/2)*i+57 |
     +---+------------------------------------------------------------------------------+---------------------------------+
     |r=4|hilbFun : {1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 66, 78, 91, 105, 120, 138}    |hilbPoly : (3/2)*i^2-(41/2)*i+97 |
     +---+------------------------------------------------------------------------------+---------------------------------+
     |r=5|hilbFun : {1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 66, 78, 91, 105, 120, 136}    |hilbPoly : (3/2)*i^2-(51/2)*i+147|
     +---+------------------------------------------------------------------------------+---------------------------------+
     |r=6|hilbFun : {1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 66, 78, 91, 105, 120, 136}    |hilbPoly : (3/2)*i^2-(61/2)*i+208|
     +---+------------------------------------------------------------------------------+---------------------------------+

i6 : 
     
     
     
     
